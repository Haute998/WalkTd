@using WeModels
@using WeModels.Models.C_UserModel
@{
    Layout = null;
    C_UserVM IntroducerData = ViewData["IntroducerData"] as C_UserVM;//推荐人信息
    //InviteCode code = ViewData["code"] as InviteCode;
    string type = ViewData["type"] as string;
    string Introducer = ViewData["Introducer"] as string;//推荐人
    C_UserType applyUserType = ViewData["applyUserType"] as C_UserType;

    C_UserVM P_User = ViewData["P_User"] as C_UserVM;//上级信息
}

<!DOCTYPE html>

<html>
<head>
    <title>代理申请 - 微商系统演示版</title>
    <meta http-equiv="X-UA-Compatible" content="IE=7,IE=9" />
    <meta name='viewport' content='width=640px, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no,target-densitydpi=device-dpi' />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <link href="/css/jlpmain.css?20161222" rel="stylesheet" type="text/css" />
    <script src="~/js/jquery-1.10.2.min.js"></script>
    <script src="~/js/Common/layer.mobile-v2.0/layer_mobile/layer.js"></script>
    <style type="text/css">
        .centent_total .sqdls_up table.t1 {
            margin-bottom: 20px;
        }

        .centent_total .sqdls_up table.t22 tr td.td1 {
            width: 30%;
            height: 45px;
            line-height: 40px;
            float: left;
            color: #323232;
            font-size: 15px;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .centent_total .sqdls_up table.t22 tr td.td2 {
            width: 70%;
            float: right;
        }

            .centent_total .sqdls_up table.t22 tr td.td2 input, .centent_total .sqdls_up table.t22 tr td select {
                width: 100%;
                text-indent: 5px;
                float: left;
                height: 35px;
                color: #333;
                font-size: 12px;
                font-family: Microsoft YaHei;
                font-weight: normal;
                background-color: #cdcdcd;
                border-radius: 0;
                -moz-border-radius: 0;
                -webkit-border-radius: 0;
                border: 1px solid #9d9d9d;
            }

        .centent_total .sqdls_up table.t22 tr td select {
            width: 100%;
            -webkit-appearance: none;
            background-image: url(/images/88.png);
            background-repeat: no-repeat;
            background-size: 14% 104%;
            background-position: right;
            background-origin: content-box;
        }
    </style>
</head>
<body>
    <form id="form1" data-ajax="false">
        <div id="page1" data-role="page">
            <div data-role="content" id="content">
                <div class="centent_total">
                    <div class="sqdls_up">
                       

                            <table class="t1">
                                <tr>
                                    <td class="d1">
                                        <span>推荐人：</span>
                                    </td>
                                    <td class="d2">
                                      <span>@(IntroducerData.Name)</span>
                                        <input name="Introducer" type="hidden" value="@(IntroducerData.UserName)" />
                                    </td>
                                </tr>
                            </table>
                      
                        @if (P_User == null)
                        {
                            <table class="t1">
                                <tr>
                                    <td class="d1">
                                        <span>上级：</span>
                                    </td>
                                    <td class="d2">
                                        <input readonly="readonly" value="总部" />
                                        <input name="ChiefUserName" type="hidden" value="" />
                                    </td>
                                </tr>
                            </table>
                        }
                        else
                        {

                            <table class="t1">

                                <tr>
                                    <td class="d1">
                                        <span>授权编号：</span>
                                    </td>
                                    <td class="d2">
                                        <input  readonly="readonly" value="@(P_User.Identifier)" />
                                        <input type="hidden" name="ChiefUserName" readonly="readonly" value="@(P_User.UserName)" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="d1">
                                        <span>上级名称：</span>
                                    </td>
                                    <td class="d2">
                                        <input name="ChiefName" readonly="readonly" value="@(P_User.Name)" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="d1">
                                        <span>上级级别：</span>
                                    </td>
                                    <td class="d2">
                                        <input name="ChiefType" readonly="readonly" value="@(P_User.userTypeName)" />
                                    </td>
                                </tr>
                            </table>
                        }
                      
                        <table class="t22">
                            <tr>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="td1">
                                    申请级别：
                                </td>
                                <td class="td2">
                                   <input type="hidden" id="C_UserTypeID" name="C_UserTypeID" value="@(applyUserType.Lever)" /><label>@(applyUserType.Name)</label>
                                       
                                  

                              
                            </tr>
                            <tr>
                                <td class="td1">
                                    姓名：
                                </td>
                                <td class="td2">
                                    <input name="Name" id="Text3" type="text" placeholder="请输入申请人全名（必填）" />
                                </td>
                            </tr>
                            <tr>
                                <td class="td1">
                                    微信号：
                                </td>
                                <td class="td2">
                                    <input id="Text4" name="wxNo" type="text" placeholder="请输入真实微信（必填）" />
                                </td>
                            </tr>
                            <tr>
                                <td class="td1">
                                    手机号：
                                </td>
                                <td class="td2">
                                    <input id="Text6" name="Phone" type="text" maxlength="11" placeholder="请输入有效电话号码（必填）" />
                                </td>
                            </tr>
                            <tr>
                                <td class="td1">
                                    身份证：
                                </td>
                                <td class="td2">
                                    <input id="Text5" name="Card" maxlength="18" type="text" placeholder="请输入正确有效的身份证（必填）" />
                                </td>
                            </tr>

                            <tr>
                                <td class="td1">
                                    所在地：
                                </td>
                                <td class="td2">
                                    <input readonly="readonly" id="PCAs" name="PCAs" type="text" placeholder='请选择' />
                                    <input id="PCAids" name="PCAids" type="hidden" value="" />
                                </td>
                            </tr>
                            <tr>
                                <td style="height: 10px;"></td>
                            </tr>
                            <tr>
                                <td class="rsx111">
                                    <input id="file_temporaryImage" hidden="hidden" type="file" name="file_temporaryImage" />
                                    <div id="setimg">

                                        <img id="idcardshow" src="/images/74.png" alt="" />
                                        <span>身份证正面照片（必填）</span>
                                    </div>
                                </td>
                            </tr>

                            <tr>
                                <td style="height: 20px;"></td>
                            </tr>
                            <tr class="r1">
                                <td style="text-align: center;">
                                    <button onclick="TemporaryMedia()" type="button" style="background-color: #40B7AB; color: white; padding: 10px; width: 80%; border-radius: 5px; border: 0; border: none; ">提交</button>
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                            </tr>
                        </table>
                        <p id="msg" style="text-align:center"></p>
                    </div>
                </div>
            </div>
            @*<div class="All_foot">
                    <div class="foot">
                        <table>
                            <tr>
                                <td>
                                    <a href="/">
                                        <div class="div1">
                                            <img src="/images/25.png" alt="" />
                                        </div>
                                        <div class="div2">
                                            返回首页
                                        </div>
                                    </a>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>*@
        </div>
    </form>
</body>
</html>
<script src="~/js/Common/jquery.form.js"></script>
<script src="~/js/Common/Datehelper.js"></script>
<script src="~/js/Common/desHelper.js"></script>

<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>


<link href="~/js/setcity2/css/LArea.css?201707141613" rel="stylesheet" />
<script src="~/js/setcity2/js/LAreaData1.js?201707141613"></script>
<script src="~/js/setcity2/js/LArea.js?201707141613"></script>
<script>
    var area1 = new LArea();
    area1.value = ["", "", ""];//控制初始位置，注意：该方法并不会影响到input的value

    area1.init({
        'trigger': '#PCAs', //触发选择控件的文本框，同时选择完毕后name属性输出到该位置
        'valueTo': '#PCAids', //选择完毕后id属性输出到该位置
        'keys': {
            id: 'name',
            name: 'name'
        }, //绑定数据源相关字段 id对应valueTo的value属性输出 name对应trigger的value属性输出
        'type': 1, //数据源类型
        'data': LAreaData //数据源
    });
</script>
<script>
    var loading;
    //var time;
    var type = "@(type)";
    $(function ()
    {
        //if (type == "code")
        //{
        //    time = setInterval("setTimeing()", 1000);
        //}
        $("#setimg").on("tap", function () {
            $("#file_temporaryImage").click();
        });


        $(".ui-btn-inner").hide();
        $("#file_temporaryImage").change(function (e) {
            var file = e.target.files[0] || e.dataTransfer.files[0];
            if (file) {
                var reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = function () {
                    var img = new Image();
                    img.src = this.result;
                    $("#idcardshow").attr("src", this.result);
                }
            }
        });
    })
    function TemporaryMedia() {
        //判断上传控件中是否选择了图片
        var image = $("#file_temporaryImage").val();
        if ($.trim(image) == "") {
            layer.open({ content: "请上传身份证！", btn: '我知道了' });
            return;
        }
        loading = layer.open({
            type: 2
 , content: '提交中'
        });
        //提交请求处理的url
        var actionUrl = "/agentApply/toApply_Recommended";
        //开始ajax操作
        $("#form1").ajaxSubmit({

            type: "POST",//提交类型
            url: actionUrl,//请求地址
            data: {},//请求数据
            success: function (rtn) {//请求成功后的函数
                layer.close(loading);
                if (rtn == "ok") {
                    layer.open({
                        content: "恭喜您，已经提交成功，等待审核",
                        btn: '我知道了',
                        yes: function (index) {
                            layer.close(index);
                            window.location.href = "/Home/Login";
                        }
                    });
                }
                else
                {
                    layer.open({ content: rtn, btn: '我知道了' });
                }
            },
            error: function (rtn) {
                layer.close(loading);
                layer.open({ content: rtn, btn: '我知道了' });
            },//请求失败的函数
            async: true

        });


    }

    @*function setTimeing() {
        var nowDat = new Date();
        var validDat = new Date("@(!string.IsNullOrWhiteSpace(type)?code.ValidDat.ToString("yyyy/MM/dd HH:mm:ss"):"")");

        var date3 = validDat.getTime() - nowDat.getTime();  //时间差的毫秒数
        //计算出小时数
        var leave1 = date3 % (24 * 3600 * 1000);
        var hours = Math.floor(leave1 / (3600 * 1000));
        //计算相差分钟数
        var leave2 = leave1 % (3600 * 1000);
        var minutes = Math.floor(leave2 / (60 * 1000));
        //计算相差秒数
        var leave3 = leave2 % (60 * 1000);
        var seconds = Math.round(leave3 / 1000);
        $("#msg").html("邀请码有效期剩余：<span style='color:red'>" +  minutes + " </span>分<span style='color:red'>" + seconds + "</span> 秒");

        if (date3 <= 0)
        {
            clearInterval(time);
            $("#msg").html("<span style='color:red'>该邀请链接已失效</span>");
            layer.open({
                content: "该邀请链接已失效",
                btn: '我知道了',
                yes: function (index) {
                    layer.close(index);
                    window.location.href = "/Home/Index";
                }
            });

        }

    }*@
</script>